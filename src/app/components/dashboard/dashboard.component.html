<div class="dashboard-container">
  <h2>Dashboard</h2>
  
  <div class="facture-form">
    <h3>Create New Facture</h3>
    <div class="form-group">
      <label for="numero">Numero:</label>
     <input type="number" 
       id="numero" 
       class="form-control"
       [ngModel]="currentFacture.numero ?? 0" 
       (ngModelChange)="currentFacture.numero = $event">

    </div>
    <div class="form-group">
      <label for="date">Date:</label>
      <input 
  type="date" 
  id="date" 
  class="form-control"
  [ngModel]="currentFacture.date | date:'yyyy-MM-dd'" 
  (ngModelChange)="currentFacture.date = $event">
    </div>
    
<div class="form-group">
  <label for="fournisseur">Fournisseur:</label>
  <select id="fournisseur"
          [(ngModel)]="selectedFournisseur"
          [compareWith]="compareFournisseur"
          class="form-control">
    <option *ngFor="let f of fournisseurs" [ngValue]="f">
      {{ f.nom }}
    </option>
  </select>
</div>



  <div class="articles-section">
    <h3>Articles</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Libelle</th>
          <th>Prix</th>
          <th>TVA</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let article of articles">
          <td>{{article.code}}</td>
          <td>{{article.libelle}}</td>
          <td>{{article.prix | currency:'TND'}}</td>
          <td>{{article.tva}}%</td>
          <td>
            <button (click)="addArticleToFacture(article)" class="btn btn-primary">Add</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="selected-articles">
    <h3>Selected Articles</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Libelle</th>
          <th>Prix</th>
          <th>Quantity</th>
          <th>Total</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let article of selectedArticles">
          <td>{{article.code}}</td>
          <td>{{article.libelle}}</td>
          <td>{{article.prix | currency:'TND'}}</td>
          <td>
            <input type="number" 
       [ngModel]="article.quantity ?? currentFacture.quantity" 
       (ngModelChange)="article.quantity = $event" 
       (change)="calculateTotal()" 
       min="1">

          </td>
          <td>{{(article.prix * article.quantity * (1 + article.tva / 100)) | currency:'TND'}}</td>
          <td>
            <button (click)="removeArticleFromFacture(article)" class="btn btn-danger">Remove</button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="total-amount">
      <strong>Total: {{totalAmount | currency:'TND'}}</strong>
    </div>
    <button (click)="validateFacture()" class="btn btn-success">Valider</button>
  </div>
<div>
  <button class="btn btn-sm btn-secondary" (click)="printFacture(currentFacture)">
            Imprimer
          </button>
</div>

</div>